# 🧾TIL

## 날짜: 2025-05-30 ✨

## 새로 배운 내용

## 📦 라이브러리를 청크로 분리하고자 하는 이유

### 1. 초기 로딩 속도 개선

- 브라우저는 **필요한 앱 코드만 먼저 로딩하고,** 무거운 라이브러리는 **캐시된 청크에서 비동기 로딩**할 수 있다.
- 특히 `react`, `chart.js` 같은 **대형 라이브러리**는 자주 바뀌지 않기 때문에, 청크로 분리해 두면 브라우저 캐시에 저장되어 다시 다운로드하지 않는다.

### 2. 브라우저 캐시 최적화

- 라이브러리 코드는 자주 변경되지 않기 때문에,
  **한 번 캐싱되면 재배포 후에도 재사용** 가능하다.
- 앱 코드만 바뀌면 앱 관련 청크만 갱신되므로 **전체 재다운로드가 줄어든다.**

### 3. 코드 가독성과 번들 구조 관리에 유리

- 청크 분리를 명시적으로 설정하면 어떤 모듈이 어디에 포함되는지 **제어가 쉽다 (협업 관점)**

## 분리 계획

자주 바뀌지 않는 라이브러리 혹은 특정 페이지에서만 사용되는 라이브러리를 위주로 분리할 계획이다.

- `react-vendor` : `react`, `react-dom`
- `router` : `react-router-dom`
- `query` : `@tanstack/react-query` , `@tanstack/react-query-devtools`
- `chartjs` : `chart.js` , `react-chartjs-2`
- `mathjax` : `better-react-mathjax`

## 분리 후

기존에는 초기 로딩 시 다운로드 해야 할 파일이 하나였다면 분리 후 여러 개가 되었다.

또, 병렬 다운로드 되어 결과적으로 미약하지만 js 다운로드 시간이 10초 -> 8초로 줄었다.

## 오늘의 회고

오늘은 기존의 페이지, 컴포넌트 단위 코드 스플리팅, 지연 로딩에 이어 라이브러리를 청크로 분할해보았다.

수정될 일이 거의 없는 라이브러리를 기존의 메인 js로부터 분할하여, 효율적으로 캐싱할 수 있었다.

또 이런 라이브러리 청크 분할 이외에도 코드 리팩토링을 진행했다. 기존의 버튼 관련 상태 로직 (로딩, 비활성화)은 전역적으로 사용되므로, 훅으로 빼두었다.

특히 삼항 연산자가 가독성을 해치고 있었던 코드들이 있었는데, 그 부분은 매핑을 위한 Map 데이터를 생성해 직관적이도록 수정하였다.

아직 리팩토링할 것들은 꽤나 많지만 이제 고도화 작업(테스트 코드 작성)과 v2 개발에 들어가야 하기 때문에 다시 시간이 된다면 진행해볼 생각이다.
