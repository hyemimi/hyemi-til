# ğŸ§¾TIL
## ë‚ ì§œ: 2025-03-25 ğŸ–¼ï¸
## ìƒˆë¡œ ë°°ìš´ ë‚´ìš©

## ì´ë¯¸ì§€ ì—…ë¡œë“œ êµ¬í˜„ (í”„ë¡ íŠ¸, ë°±ì—”ë“œ)

### í”„ë¡ íŠ¸ - formDataë¡œ ë°ì´í„°, ì´ë¯¸ì§€ ê°™ì´ ë³´ëƒ„

```jsx
// íšŒì›ê°€ì… ìš”ì²­ í•¨ìˆ˜
async function requestRegister() {
    //{email,password,nickname,profile_image_url}
   
    const form = document.getElementById('register-form');
    const formData = new FormData();

    formData.append('email', form.email.value);
    formData.append('password', form.password.value);
    formData.append('nickname', form.nickname.value);

    if (form.image.files.length > 0) {
        formData.append('profileImage', form.image.files[0]);
    }

    try {
        const response = await fetch(`${CONFIG.API_URL}/users`, {
            method: "POST",
            body: formData,
        });

        if (response.ok) {
            navigateTo("/boards");
        } else {
            alert("íšŒì›ê°€ì… ì‹¤íŒ¨: ì…ë ¥ì„ í™•ì¸í•˜ì„¸ìš”.");
        }
    } catch (error) {
        alert("íšŒì›ê°€ì… ì˜¤ë¥˜! ì„œë²„ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    }

}
```

- `new FormData()`: JavaScriptì—ì„œ HTML form ë°ì´í„°ë¥¼ ë‹¤ë£° ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ê°ì²´.

ì£¼ë¡œ multipart/form-data í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ì„œë²„ì— ì „ì†¡í•  ë•Œ ì‚¬ìš©

ìë™ìœ¼ë¡œ Content-Type: multipart/form-dataë¡œ ì„¤ì •ë¨

### ë°±ì—”ë“œ

| ì–´ë…¸í…Œì´ì…˜ | ì£¼ ìš©ë„ | íŠ¹ì§• |
| --- | --- | --- |
| `@RequestParam` | ì¼ë°˜ í…ìŠ¤íŠ¸ í•„ë“œ (`key=value`) | ë‹¨ìˆœ í…ìŠ¤íŠ¸ìš© |
| `@ModelAttribute` | í¼ ë°ì´í„° ì „ì²´ë¥¼ ê°ì²´ë¡œ ë§¤í•‘ | form í•„ë“œ â†’ ê°ì²´ ë°”ì¸ë”© |
| `@RequestPart` | **íŒŒì¼ì´ë‚˜ JSON ê°ì²´** ë°›ì•„ì•¼ í•  ë•Œ | multipartì—ì„œ íŒŒíŠ¸ ì¶”ì¶œ |
- @ModelAttributeëŠ” íŒŒì¼ ì œì™¸í•œ í¼ ê°ì²´ ì „ì²´ë¥¼ ë§¤í•‘, @RequestPartëŠ” íŒŒì¼ë§Œ ë§¤í•‘

- build.gradle
    
    ```jsx
      implementation 'com.amazonaws:aws-java-sdk-s3:1.12.671'
    ```
    
- controller
    
    ```java
    
      /** íšŒì›ê°€ì… */
      @Operation(summary = "íšŒì›ê°€ì…")
      @PostMapping("")
      public ResponseEntity<UserResponseDto.RegisterResponse> registerUser(
              @ModelAttribute UserRequestDto.Register request, // form-data í•„ë“œ ì§ì ‘ ë§¤í•‘
              @RequestPart(value = "profile_image_url", required = false) MultipartFile profile_image_url)  {
          User user = userService.registerUser(request,profile_image_url);
          return ResponseEntity.ok(new UserResponseDto.RegisterResponse(user));
      }
    ```
    

- `@RequiredArgsConstructor` ì• ë„ˆí…Œì´ì…˜ì€ **Lombok** ê¸°ëŠ¥ìœ¼ë¡œ, `final` í•„ë“œë“¤ì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ” ìƒì„±ìë¥¼ **ìë™ ìƒì„±**í•˜ì—¬ í¸ë¦¬í•˜ë‹¤.
- ì´ ìë™ ìƒì„±ëœ ìƒì„±ìì— ì˜í•´ `S3Uploader`ëŠ” **Springì˜ ì˜ì¡´ì„± ì£¼ì…(DI)** ì»¨í…Œì´ë„ˆ(IoC ì»¨í…Œì´ë„ˆ)ì—ì„œ ìë™ìœ¼ë¡œ ì£¼ì…ëœë‹¤.

ì¦‰, `@Service` + `@RequiredArgsConstructor` ì¡°í•© ë•ë¶„ì— ìƒì„±ì ì½”ë“œë¥¼ ì§ì ‘ ì•ˆ ì¨ë„ **Springì´ ì•Œì•„ì„œ** ì£¼ì…í•´ì¤€ë‹¤.

S3uploaderì˜ ê²½ìš° AWS S3 ë²„í‚·ì— ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œ í•˜ëŠ” ë¡œì§ì„ êµ¬í˜„í•œ ê°ì²´ì´ë‹¤.

## ì˜¤ëŠ˜ì˜ íšŒê³ 
ì˜¤ëŠ˜ì€ ê³ ë¯¼ê±°ë¦¬ì˜€ë˜ ì´ë¯¸ì§€ ì—…ë¡œë“œ êµ¬í˜„ì— ëŒ€í•´ í•´ê²°í–ˆë‹¤.

ë²„í‚·ì„ ìƒì„±í•˜ê³ , ì„¤ì •ì„ ìœ„í•œ í‚¤ë¥¼ intelliJì— ë„£ì–´ AWS S3ì™€ ì—°ë™í•˜ì˜€ê³ 

í”„ë¡ íŠ¸ì—ì„œëŠ” FormDataì— í•„ìš”í•œ request body ë°ì´í„°ì™€ MultipartFileì„ ë„£ì–´ ë³´ë‚´ë„ë¡ í–ˆë‹¤.

ë°±ì—ì„œëŠ” @ModelAttributeë¡œ request body ë°ì´í„°ë¥¼ ë§¤í•‘í•˜ê³ , @RequestPartë¡œ MultipartFileì„ ë§¤í•‘í•´ ì²˜ë¦¬í•˜ë„ë¡ êµ¬í˜„í–ˆë‹¤.

S3ëŠ” ê¸°ì´ˆ ì‹¤ìŠµì„ í•´ë³¸ ê²½í—˜ì´ ìˆì§€ë§Œ, í”„ë¡ íŠ¸/ë°± í†µì‹ ì„ í†µí•œ ì—…ë¡œë“œ,ì¡°íšŒëŠ” ì²˜ìŒ ì‹œë„í•˜ì—¬ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦´ ê²ƒì´ë¼ ìƒê°í–ˆëŠ”ë° ìƒê°ë³´ë‹¤ ë¹ ë¥´ê²Œ êµ¬í˜„ë˜ì—ˆë‹¤.

ì´ë¯¸ì§€ì™€ body ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ê°™ì´ ë³´ë‚¼ ìˆ˜ ìˆì„ê¹Œ ê±±ì •í–ˆëŠ”ë°, ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ FormDataë¡œ ë‹´ì•„ ë³´ë‚´ë©´ ëœë‹¤ëŠ” ê²ƒì„ ì²˜ìŒ ì•Œê²Œ ë˜ì–´ ë¿Œë“¯í•˜ë‹¤.!
