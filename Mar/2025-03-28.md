# 🧾TIL
## 날짜: 2025-03-28 🌊

# 질문: React에서 DOM 이벤트를 직접 처리하지 않고 추상 레이어를 통해서 이벤트를 처리합니다. 이 과정에서 이벤트 위임이 어떻게 이루어지고 처리하는지 서술하시오.

## 1. 이벤트 리스너 등록 (위임)

React는 이벤트를 다루기 위해 이벤트 리스너를 React 루트 요소에 붙이고 있다. (17부터 root, 16까지는 Document)

이벤트가 발생하면 이벤트가 **버블링(하위 요소에서 상위 요소로 전달)**되어 루트 요소까지 올라가고, 루트 요소에 등록된 이벤트 리스너가 이를 가로챈다.

> **React 16 → 17 변경사항 (이벤트 위임 주체 변경)**
> 

이전에는 React가 이벤트를 document에 등록했기 때문에, React 앱 바깥의 다른 JS코드가 등록한 이벤트와 충돌이 발생할 수 있었다. 

그러나 17버전부터 이벤트 리스너를 Root element에 등록해, React 앱 외부와 내부의 이벤트 시스템을 깔끔히 분리했다.  

## 2. React가 이벤트 분석

- 어떤 DOM 요소에서 이벤트가 시작됐는지 확인 → fiber 노드를 찾고 → 안에 저장된 memoizedProps 에서 핸들러 꺼내 실행
    - **fiber 노드란? React가 컴포넌트 구조를 기억하고, 업데이트를 처리하기 위해 만든 객체 구조**
- 그 요소에 대응되는 **가상 DOM 컴포넌트 정보**를 확인

## 3. 이벤트 객체 래핑 (추상레이어)

- React가 이벤트 객체를 **`SyntheticEvent` 객체(합성 객체, = 추상레이어)로 감싸서 핸들러에 전달되고 실행된다.**

```jsx
function handleClick(event) {
  // event: SyntheticEvent
}

<button onClick={handleClick}>Click</button>
```

- 위와 같이 핸들러를 등록했을 때 핸들러에 전달되는 event가 바로 SyntheticEvent
- **브라우저마다 다른 속성을 통일해서 만들어진 이벤트 래퍼**로, 크로스 브라우징 문제를 해결하기 위한 방법 중 하나이다.

## 오늘의 회고
오늘은 모의 면접 시간을 가졌다.

React의 "이벤트 위임" 을 주제로 공부했고, React가 16버전까지 개별 DOM이 아니라 이벤트 버블링을 통해 Document에 이벤트 처리를 위임했다면(리스너 등록)

17버전부터는 Root에 이벤트를 위임했다. 이렇게 변경된 이유는 React 앱 외부의 JS 코드에서 등록한 이벤트와 혼동될 수 있기 때문에, 분리하기 위함이다.

모의 면접을 진행하며 이렇게 버전 별로 왜 바뀌었는지 이해하는지도 중요하다는 것을 깨달았다.

어떤 점이 불편해서 어떻게 바뀌었는지! 이러한 점을 이해할 줄 아는 개발자가 같이 일하고 싶은 개발자라고 하셨다.

그동안 나는 변화의 이유에 집중하지 않았던 것 같아 반성이 되는 시간이었던 것 같다.

아무튼!! Root에서 리스너에 의해 가로채진 이벤트는 React 측에서 어떤 DOM에서 발생한 이벤트인지 Fiber 노드를 찾고,  SyntheticEvent 객체를 생성해 브라우저 이벤트 객체를 감싸서, 핸들러에 전달하면 핸들러가 실행된다.

핸들러에 들어오는 event가 바로 그 합성 객체다. 나는 그동안 그러려니 하고 가져다 썼었는데 .. 이번 기회에 원리를 조금이나마 이해하게 된 것 같아 다행이다.





