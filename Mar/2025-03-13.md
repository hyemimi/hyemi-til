# ğŸ§¾TIL
## ë‚ ì§œ: 2025-03-13 ğŸ·

## ìƒˆë¡œ ë°°ìš´ ë‚´ìš©
## ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ì™€ DB ì—°ê²° ì…‹íŒ…í•˜ê¸°

### 1.   í™˜ê²½

- build.gradle

```java
dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
	implementation 'org.springframework.boot:spring-boot-starter-web'
	implementation("org.springframework.boot:spring-boot-starter-data-jpa")  // JPA ì‚¬ìš©
	implementation("mysql:mysql-connector-java:8.0.33")  // MySQL ë“œë¼ì´ë²„
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
	testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}
```

- application.properties

```
spring.application.name=Jojal-Jojal
# MySQL
spring.datasource.url=jdbc:mysql://localhost:3306/my_community_db?serverTimezone=UTC&characterEncoding=UTF-8
spring.datasource.username=root
spring.datasource.password=7375
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

# JPA
spring.jpa.hibernate.ddl-auto=update
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect
spring.jpa.show-sql=true

```

### 2. Entity

<aside>

ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ 1:1 ë§¤í•‘ë˜ëŠ” ê°ì²´

**JPA**ë¥¼ ì´ìš©í•´ ìë™ìœ¼ë¡œ í…Œì´ë¸”ì„ ìƒì„±

</aside>

```java
package com.example.community.entity;

import jakarta.persistence.*;
import lombok.*;

@Entity
@Table(name = "posts")  // í…Œì´ë¸” ì´ë¦„ ì„¤ì •
@Getter
@Setter
@NoArgsConstructor
@AllArgsConstructor
@Builder
public class Post {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)  // AUTO_INCREMENT
    private Long id;

    @Column(nullable = false)
    private String title;

    @Column(nullable = false, columnDefinition = "TEXT")
    private String content;
}

```

- `Lombok` : ë°˜ë³µì ì¸ ì½”ë“œ ì‘ì„±ì„ ì¤„ì—¬ì£¼ëŠ” Java ë¼ì´ë¸ŒëŸ¬ë¦¬
    - getter, setter, ìƒì„±ì, toString() ê°™ì€ ë³´ì¼ëŸ¬ í”Œë ˆì´íŠ¸ ì½”ë“œë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•´ ì¤€ë‹¤.
- `@Entity` â†’ JPAê°€ ê´€ë¦¬í•˜ëŠ” ê°ì²´
- `@Table(name = "posts")` â†’ DBì˜ `posts` í…Œì´ë¸”ê³¼ ì—°ê²°
- `@Id` â†’ ê¸°ë³¸ í‚¤(PK)
- `@GeneratedValue(strategy = GenerationType.IDENTITY)` â†’ `AUTO_INCREMENT`
- `@Column(nullable = false)` â†’ `title`, `content` í•„ìˆ˜ ê°’

### (3) Repository

<aside>

JPAë¥¼ ì‚¬ìš©í•´ ë°ì´í„°ë² ì´ìŠ¤ì™€ ì§ì ‘ í†µì‹ í•˜ëŠ” ê³„ì¸µ
SQLì„ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šê³ ë„ CRUD ê°œë°œ ê°€ëŠ¥!

</aside>

```java
package com.example.community.repository;

import com.example.community.entity.Post;
import org.springframework.data.jpa.repository.JpaRepository;

public interface PostRepository extends JpaRepository<Post, Long> {
}

```

### (4) Service

<aside>

ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ê³„ì¸µ

</aside>

```java
package com.example.community.service;

import com.example.community.entity.Post;
import com.example.community.repository.PostRepository;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;
import java.util.Optional;

@Service
public class PostService {
    private final PostRepository postRepository;

    public PostService(PostRepository postRepository) {
        this.postRepository = postRepository;
    }

    @Transactional
    public Post createPost(Post post) {
        return postRepository.save(post);
    }

    public List<Post> getAllPosts() {
        return postRepository.findAll();
    }

    public Optional<Post> getPostById(Long id) {
        return postRepository.findById(id);
    }

    @Transactional
    public Post updatePost(Long id, Post postDetails) {
        Post post = postRepository.findById(id)
                .orElseThrow(() -> new IllegalArgumentException("ê²Œì‹œê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."));
        post.setTitle(postDetails.getTitle());
        post.setContent(postDetails.getContent());
        return postRepository.save(post);
    }

    @Transactional
    public void deletePost(Long id) {
        postRepository.deleteById(id);
    }
}

```

- `@Service` â†’ ì„œë¹„ìŠ¤ ê³„ì¸µì„ ë‚˜íƒ€ëƒ„
- `@Transactional` â†’ ë°ì´í„° ë³€ê²½ ì‹œ íŠ¸ëœì­ì…˜ì„ ì ìš© (ìë™ ë¡¤ë°± ê°€ëŠ¥)
- `postRepository.findAll()` â†’ ëª¨ë“  ê²Œì‹œê¸€ ì¡°íšŒ
- `postRepository.findById(id)` â†’ íŠ¹ì • ê²Œì‹œê¸€ ì¡°íšŒ
- `postRepository.save(post)` â†’ ê²Œì‹œê¸€ ìƒì„±/ìˆ˜ì •
- `postRepository.deleteById(id)` â†’ ê²Œì‹œê¸€ ì‚­ì œ

â‡’ findAll, findById, save, deleteByIdê°€ ëª¨ë‘ JpaRepositoryì—ì„œ ì œê³µí•˜ëŠ” ë©”ì†Œë“œë¼ë‹ˆ! ìƒë‹¹íˆ í¸ë¦¬í•œ ê²ƒ ê°™ë‹¤. ê·¸ë¦¬ê³ , DBë¥¼ ìˆ˜ì •í•˜ëŠ” ë¡œì§ë“¤ì—ëŠ” `@Transactional` ì„ ê¼­ ë¶™ì—¬ì¤€ë‹¤. ê·¸ë¦¬ê³  null ê°’ì´ ê°€ëŠ¥í•œ ë³€ìˆ˜ë“¤ì—ëŠ” Optionalë¡œ ì„ ì–¸í•´ì¤€ë‹¤. 

### (5) Controller

<aside>

í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ì•„ Serviceë¥¼ í˜¸ì¶œí•˜ê³ , ê°’ì„ ì „ë‹¬

APIì˜ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì •ì˜í•œë‹¤.

</aside>

```java
package com.example.community.controller;

import com.example.community.entity.Post;
import com.example.community.service.PostService;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;
import java.util.Optional;

@RestController
@RequestMapping("/api/posts")
public class PostController {
    private final PostService postService;

    public PostController(PostService postService) {
        this.postService = postService;
    }

    // ê²Œì‹œê¸€ ì „ì²´ ì¡°íšŒ
    @GetMapping
    public ResponseEntity<List<Post>> getAllPosts() {
        return ResponseEntity.ok(postService.getAllPosts());
    }

    // ê²Œì‹œê¸€ ë‹¨ì¼ ì¡°íšŒ
    @GetMapping("/{id}")
    public ResponseEntity<Post> getPostById(@PathVariable Long id) {
        Optional<Post> post = postService.getPostById(id);
        return post.map(ResponseEntity::ok).orElseGet(() -> ResponseEntity.notFound().build());
    }

    // ê²Œì‹œê¸€ ìƒì„±
    @PostMapping
    public ResponseEntity<Post> createPost(@RequestBody Post post) {
        return ResponseEntity.ok(postService.createPost(post));
    }

    // ê²Œì‹œê¸€ ìˆ˜ì •
    @PutMapping("/{id}")
    public ResponseEntity<Post> updatePost(@PathVariable Long id, @RequestBody Post postDetails) {
        return ResponseEntity.ok(postService.updatePost(id, postDetails));
    }

    // ê²Œì‹œê¸€ ì‚­ì œ
    @DeleteMapping("/{id}")
    public ResponseEntity<Void> deletePost(@PathVariable Long id) {
        postService.deletePost(id);
        return ResponseEntity.noContent().build();
    }
}

```

- `@RestController` â†’ RESTful APIë¥¼ ì²˜ë¦¬í•˜ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬
- `@RequestMapping("/api/posts")` â†’ ê¸°ë³¸ URL ê²½ë¡œ ì„¤ì •
- `@GetMapping`, `@PostMapping`, `@PutMapping`, `@DeleteMapping` â†’ HTTP ë©”ì„œë“œ ì§€ì •
- `@PathVariable` â†’ URL ê²½ë¡œì—ì„œ ë³€ìˆ˜ ê°’ ì¶”ì¶œ
- `@RequestBody` â†’ JSON ìš”ì²­ ë°ì´í„°ë¥¼ `Post` ê°ì²´ë¡œ ë³€í™˜
- `ResponseEntity` â†’ HTTP ì‘ë‹µì„ ìœ ì—°í•˜ê²Œ ë°˜í™˜

## ì˜¤ëŠ˜ì˜ íšŒê³ 
ì˜¤ëŠ˜ì€ ë³¸ê²©ì ìœ¼ë¡œ REST APIë¥¼ ê°œë°œ ì‹œì‘í–ˆë‹¤. 

Entityë¥¼ ìƒì„±í•˜ê³ , JpaRepositoryë¥¼ êµ¬í˜„í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•´ Service ë¡œì§ì„ ì§°ë‹¤.

ì•½ê°„ ì‹ ì„¸ê³„ì²˜ëŸ¼ ëŠê»´ì¡Œë‹¤ .. jpaë¥¼ ì‚¬ìš©í•˜ë‹ˆ db ê´€ë ¨í•˜ì—¬ ì§¤ ì½”ë“œë“¤ì´ í™•ì—°íˆ ì¤„ì–´ë“œëŠ” ëŠë‚Œì´ì—ˆë‹¤.

ë˜, mvc íŒ¨í„´ì„ ì ìš©í•˜ê¸°ì— ìµœì í™”ëœ ê²ƒ ê°™ë‹¤. ì •í˜•í™”ëœ í…œí”Œë¦¿ì´ ìˆë‹¤ë³´ë‹ˆ ìœ ì§€ë³´ìˆ˜ê°€ ìˆ˜ì›”í•  ê²ƒ ê°™ë‹¤.

ì•„ë¬´íŠ¼ ... ì‹ ê¸°í•˜ê³  .. ìµìˆ™í•´ì§€ë©´ ì¡°ê¸ˆ ë” ìˆ˜ì›”í•˜ê²Œ ê°œë°œí•  ìˆ˜ ìˆì„ ê²ƒ ê°™ì€ ëŠë‚Œì´ë‹¤.

ê°œë°œì€ í–ˆì§€ë§Œ ì¡°ê¸ˆ ë” ì—ëŸ¬ í•¸ë“¤ë§ì— ì‹ ê²½ì„ ì¨ì•¼í•  ê²ƒ ê°™ë‹¤.


### ì°¸ê³  ìë£Œ ë° ë§í¬
